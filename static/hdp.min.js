! function(a) {
	"use strict";
	a.hdp || (a.hdp = {});
	var b = a.hdp;
	b.version = "0.0.5";
	var c = ["", "setTitle", "setIcon", "pushWindow", "popWindow", "popToRoot", "sendNotification", "registerNotification", "sendEvent", "tips", "setNavgationBackground", "setStatusBarLight", "postResult", ""].join("-"),
		d = function(a, b, d, e) {
			var f = a.split(".");
			if (f = f[f.length - 1], c.indexOf("-" + f + "-") > -1) return b;
			switch (a) {
				case "mgj.sms.send":
				case "mgj.device.signParams":
					b.push(function(a) {
						a = r(a), d(a)
					}, function(a) {
						e(a)
					});
					break;
				case "mgj.location.pickLocationInfo":
				case "mgj.app.isInstalled":
					b.unshift(function(a) {
						a = r(a), d(a)
					});
					break;
				case "navigator.notification.alert":
				case "navigator.notification.confirm":
					b.splice(1, 0, function(a) {
						d(a)
					});
					break;
				case "mgj.ajax.ajax":
				case "mgj.ajax.ajaxOrigin":
					var g = b[0];
					if (g.success) {
						var h = g.success;
						g.success = function(a) {
							h.apply(null, arguments), d(a)
						}
					} else g.success = function(a) {
						d(a)
					};
					g.error || (g.error = function(a) {
						e(a)
					});
					break;
				default:
					b.unshift(function(b) {
						b = r(b), "mgj.user.getUserInfo" == a && b.result ? d(b.result) : "mgj.device.getInfo" == a && b.deviceId ? (b.deviceID = b.deviceId, d(b)) : d(b)
					}, function(a) {
						e(a)
					})
			}
			return b
		},
		e = a.Promise,
		f = function(a) {
			this.state = "pending", this.value = null, this.reason = null, this.callback = {
				isDispatch: !1
			}, "function" == typeof a && a.call(null, this.resolve.bind(this), this.reject.bind(this))
		};
	f.prototype.resolve = function(a) {
		"pending" == this.state && (this.state = "fulfilled", this.value = a, this._dispatch())
	}, f.prototype.reject = function(a) {
		"pending" == this.state && (this.state = "rejected", this.reason = a, this._dispatch())
	}, f.prototype.then = function(a, b) {
		return "function" == typeof a && (this.callback.fulfill = a), "function" == typeof b && (this.callback.reject = b), "pending" != this.state && setTimeout(function() {
			this._dispatch()
		}.bind(this), 10), this.callback.promise = new f, this.callback.promise
	}, f.prototype["catch"] = function(a) {
		return this.then(null, a)
	}, f.prototype._dispatch = function() {
		if ("pending" != this.state && !this.callback.isDispatch) {
			var a = this.callback,
				b = a.promise,
				c = null;
			try {
				switch (this.state) {
					case "fulfilled":
						if (!a.fulfill) return b && b.resolve(this.value);
						c = a.fulfill(this.value), a.isDispatch = !0;
						break;
					case "rejected":
						if (!a.reject) return b && b.reject(this.reason);
						c = a.reject(this.reason), a.isDispatch = !0
				}
				null == c ? b.resolve(c) : c instanceof f || "function" == typeof c.then ? c.then(b.resolve.bind(b), b.reject.bind(b)) : b.resolve(c)
			} catch (d) {
				b.reject(d)
			}
		}
	}, e || (e = f);
	var g = "",
		h = function(a, c) {
			return "mgj.ajax.mwp" == a ? new e(function(a, d) {
				g ? i(c, a, d) : b["do"]("mgj.device.getInfo").then(function(b) {
					g = b.appVersion, i(c, a, d)
				})
			}) : void 0
		},
		i = function(a, b, c) {
			return "732" == g || "733" == g ? void c(l) : (a.unshift(function(a) {
				b(a)
			}, function(a) {
				c(a)
			}), m && a.unshift(m), void(mgj.ajax && mgj.ajax.mwp ? mgj.ajax.mwp.apply(null, a) : c(l)))
		},
		j = navigator.userAgent.toLowerCase(),
		k = "**hdp:环境不是容器",
		l = "**hdp:没有对应的接口:",
		m = "",
		n = !1,
		o = function(a) {
			return new e(function(b, c) {
				n ? window[a] ? b(window[a]) : c(l) : p() ? document.addEventListener("deviceready", function() {
					n = !0, window[a] ? b(window[a]) : c(l)
				}, !1) : c(k)
			})
		},
		p = function(a) {
			if (a) return j.indexOf(a) > -1;
			for (var b = ["mogujie", "tt", "uni", "go", "xiaodian", "ambuyer", "amcustomer", "meilishuo"], c = 0, d = b.length; d > c; c++)
				if (j.indexOf(b[c]) > -1) return !0;
			return !1
		},
		q = function(a, b) {
			if (3 != b.length) {
				for (var c = a, d = 1, e = b.length; e > d && (c = c[b[d]], c); d++)
					if (d == e - 1) return c
			} else if (a[b[1]]) return a[b[1]][b[2]]
		},
		r = function(a) {
			try {
				return a && "string" == typeof a ? JSON.parse(a) : a
			} catch (b) {
				return a
			}
		},
		s = function(a, b, c, d, e) {
			var f = b.concat(),
				g = function(b) {
					b = r(b), "mgj.user.getUserInfo" == a && b.result ? c(b.result) : "mgj.device.getInfo" == a && b.deviceId ? (b.deviceID = b.deviceId, c(b)) : c(b)
				},
				h = function(a) {
					d(a)
				};
			return "mgj.pevent" != a || e ? "uni.resultnotification.postResult" == a ? f.unshift(m) : f.unshift(m, g, h) : f.unshift(g, h), f
		};
	b.isApp = p, b.getObj = o, b.setSecret = function(a) {
		m = a
	}, "object" == typeof cordova && cordova.hdp_secret && (m = cordova.hdp_secret), b["do"] = function(a) {
		if (a) {
			var b = Array.prototype.slice.call(arguments, 1),
				c = a.split(".");
			if ("mgj.ajax.mwp" == a) return h(a, b);
			var f = null;
			return new e(function(e, g) {
				o(c[0]).then(function(h) {
					f = q(h, c), f || g(l + a);
					var i = f.hdp_wrap_fn;
					m ? b = s(a, b, e, g, i) : (console.log("**hdp:未注入birdgeSecret"), b = d(a, b, e, g)), f && f.apply(null, b)
				})["catch"](function(a) {
					g(a)
				})
			})
		}
	}, "undefined" != typeof module && "object" == typeof exports ? module.exports = b : "function" == typeof define && (define.amd || define.cmd) && define("hdp", function() {
		return b
	})
}(window);